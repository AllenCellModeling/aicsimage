<?xml version="1.0" encoding="UTF-8"?>
<ivysettings>
    <settings defaultResolver="main" />

    <caches defaultCacheDir="${user.home}/.ivy2/cache"
            ivyPattern="[organisation]/[module]/ivy-[revision].xml"
            artifactPattern="[organisation]/[module]/[artifact]-[revision].[ext]">
        <cache name="internal-cache" useOrigin="true"
               basedir="${user.home}/.ivy2/internal-cache/" />
    </caches>

    <property name="wheelpattern" value="[module]-[revision]-py2.py3-none-any.[ext]"/>
    <property name="aics.repo.url" value="https://artifactory.corp.alleninstitute.org:443/artifactory"/>


    <resolvers>
        <!-- Local cache -->
        <filesystem name="localhost" changingPattern=".*" cache="internal-cache">
            <ivy pattern="${user.home}/.ivy2/py/[organisation]/[module]/[revision]/ivy-[revision].xml" />
            <artifact pattern="${user.home}/.ivy2/py/${wheelpattern}" />
        </filesystem>

        <!-- AICS pypi release repo -->
        <url name="pypi-release-local" m2compatible="true" changingPattern=".*">
            <artifact pattern="${aics.repo.url}/pypi-release-local/${wheelpattern}" />
        </url>

        <!-- AICS pypi snapshot repo -->
        <url name="pypi-snapshot-local" m2compatible="true" changingPattern=".*">
            <artifact pattern="${aics.repo.url}/pypi-snapshot-local/${wheelpattern}" />
        </url>

        <!-- Allow 3rd party read-only repository -->
        <ibiblio name="public" m2compatible="true" root="${aics.repo.url}/ivy-virtual" />

        <chain name="main">
            <resolver ref="localhost"/>
            <resolver ref="pypi-release-local"/>
            <resolver ref="pypi-snapshot-local"/>
            <resolver ref="public"/>
        </chain>
    </resolvers>
</ivysettings>